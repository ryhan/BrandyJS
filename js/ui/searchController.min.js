/* Search Controller */// Store all search related values in this object
function updateResults(){searchModel.query=searchModel.searchInput.value;var e=(new Date).getTime();if(e-searchModel.lastUpdate<500)return!0;searchModel.query==searchModel.cachedQuery?searchModel.loadCount+=.5:searchModel.loadCount=1;searchModel.cachedQuery=searchModel.query;if(searchModel.query==""){$("#results")[0].innerHTML="";$("#helptext").css("opacity",1);$("#loading").css({opacity:0,height:0});return!0}$("#helptext").css("opacity",0);$("#loading").css({opacity:1,height:"100px"});searchModel.loadCount>=30&&$("#loading").css({opacity:0,height:0});searchModel.lastUpdate=e;var t=_.first(_.map(suggestNames(searchModel.query),function(e){var t=e.replace(searchModel.query,"<strong>"+searchModel.query+"</strong>");return{id:e,text:t}}),searchModel.loadCount),n=document.createElement("div"),r=document.createElement("ul");for(var i=0;i<t.length;i++){var s=document.createElement("li"),o=document.createElement("span");o.innerHTML=t[i].text;s.setAttribute("id","safeurl"+t[i].id);s.appendChild(o);var u=document.createElement("div");u.setAttribute("class","availability");var a=availabilityChecks(t[i].id);u.innerHTML=a.html;s.appendChild(u);a.allTaken==1&&s.setAttribute("class","taken");r.appendChild(s)}n.appendChild(r);$("#results")[0].innerHTML=n.innerHTML;setTimeout(updateResults,500)}function availabilityChecks(e){var t=isValidHandle(e),n=isValidUrl("http://"+e+".com"),r=isValidUrl("http://"+e+".me"),i=function(e,t){return t===!1?"<span class='active'>"+e+"</span>":t===!0?"<span class='taken'>"+e+"</span>":"<span>"+e+"</span>"};return{allTaken:t==1&&n==1&&r==1,html:i("@",t)+i(".COM",n)+i(".ME",r)}}function loading(){var e={lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},t=document.getElementById("loading"),n=(new Spinner(e)).spin(t)}var searchModel={};searchModel.$searchInput=$("#search");searchModel.searchInput=searchModel.$searchInput[0];searchModel.cachedQuery="";searchModel.lastUpdate=(new Date).getTime();searchModel.loadCount=1;searchModel.$searchInput.keyup(function(){searchModel.query=searchModel.searchInput.value;updateResults();setTimeout(updateResults,500)});loading();